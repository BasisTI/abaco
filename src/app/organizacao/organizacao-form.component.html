<div class="ui-g ui-fluid">
  <div class="ui-g-12">
    <div class="card card-w-title">
      <h1>{{ organizacao.id ? 'Editar Organização' : 'Incluir Organização' }}</h1>
      <form name="editForm" role="form" novalidate (ngSubmit)="save()" #editForm="ngForm">
        <div class="ui-g">
          <div class="ui-g-2" style="margin-bottom: 25px">
            <span class="md-inputfield" >
              <input type="text" name="sigla" [(ngModel)]="organizacao.sigla" pInputText/>
              <label>Sigla</label>
            </span>
          </div>
          <div class="ui-g-10" style="margin-bottom: 25px">
            <span class="md-inputfield" >
              <input type="text" name="nome" [(ngModel)]="organizacao.nome" pInputText/>
              <label>Nome da Organização</label>
            </span>
          </div>
          <div class="ui-g-5" style="margin-bottom: 25px">
            <span class="md-inputfield">
              <input type="text" name="cnpj" [(ngModel)]="organizacao.cnpj" pInputText/>
              <label>CNPJ</label>
            </span>
          </div>
          
          <div class="ui-g-5" style="margin-bottom: 25px">
            <span class="md-inputfield">
              <input type="text" name="numeroOcorrencia" [(ngModel)]="organizacao.numeroOcorrencia" pInputText/>
              <label>Numero da Ocorrência</label>
            </span>
          </div>

          <div class="ui-g-2" style="margin-bottom: 25px">
            <input type="checkbox" class="form-control" name="ativo" 
              id="org_ativo" [(ngModel)]="organizacao.ativo" />
            <label class="form-control-label" for="org_ativo">Ativo</label>
          </div>

          <div class="ui-g">
            <h4>Contratos</h4>

            <div class="ui-g ui-md-12" style="justify-content: flex-end">
              <div class="ui-md-3">
                <button pButton type="button" label="Novo Contrato" icon="ui-icon-add"
                  (click)="abrirDialogCadastroContrato()"></button>
              </div>
            </div>
            
            <p-dataTable [value]="organizacao.contracts"
              [immutable]="false" #contratosDataTable>
              <p-column header="Número do Contrato" field="numeroContrato"></p-column>
              <p-column header="Ínicio Vigência" field="dataInicioVigencia">
                <ng-template let-col let-dataInicioVigencia="rowData" pTemplate="body">
                  {{ dataInicioVigencia[col.field] | date: 'dd/MM/y' }}
                </ng-template>
              </p-column>
              <p-column header="Final Vigência" field="dataFimVigencia">
                <ng-template let-col let-dataFimVigencia="rowData" pTemplate="body">
                  {{ dataFimVigencia[col.field] | date: 'dd/MM/y' }}
                </ng-template>
              </p-column>
              <p-column header="Manual" field="manual.nome"></p-column>
              <p-column header="Ativo" field="ativo">
                <ng-template let-col let-ativo="rowData" pTemplate="body">
                  {{ ativo[col.field] ? 'Sim' : 'Não' }}
                </ng-template>
              </p-column>
            </p-dataTable>
          </div>
        </div>

        <div class="ui-g" style="justify-content: center; margin-top: 25px;">
          <div class="ui-g-2">
            <button pButton type="button" label="Cancelar" routerLink="/organizacao"></button>
          </div>
          <div class="ui-g-2">
            <button pButton type="submit" label="Salvar" 
              (click)="save()"
              [disabled]="editForm.form.invalid || isSaving" ></button>
          </div>
        </div>

        <p-dialog header="Contrato" [(visible)]="mostrarDialogCadastroContrato"
          [contentStyle]="{'overflow':'visible'}" [width]="800">
          <div class="ui-g">
            <div class="ui-g-6" style="margin-bottom: 25px">
              <span class="md-inputfield">
                <input type="text" name="numeroContrato" [(ngModel)]="novoContrato.numeroContrato" pInputText/>
                <label>Número do Contrato</label>
              </span>
            </div>
            <div class="ui-g-6" style="margin-bottom: 25px">
                <p-dropdown [options]="manuais" optionLabel="nome" placeholder="Manual"
                  name="manualDropdown" [(ngModel)]="novoContrato.manual"
                  [autoWidth]="false" dataKey="id"></p-dropdown>
            </div>
            <div class="ui-g-6" style="margin-bottom: 25px">
              <span class="md-inputfield">
                <p-calendar [(ngModel)]="novoContrato.dataInicioVigencia" name="dataInicioVigencia"
                  [monthNavigator]="true" [yearNavigator]="true" 
                  dateFormat="dd/mm/yy" yearRange="2000:2020"></p-calendar>
                <label>Data de Início da Vigência</label>
              </span>
            </div>
            <div class="ui-g-6" style="margin-bottom: 25px">
                <span class="md-inputfield">
                <p-calendar [(ngModel)]="novoContrato.dataFimVigencia"
                  [monthNavigator]="true" [yearNavigator]="true" name="dataFimVigencia"
                  dateFormat="dd/mm/yy" yearRange="2000:2020"></p-calendar>
                <label>Data Final da Vigência</label>
                </span>
              </div>
          </div>
          <div class = "ui-g-6" style="margin-bottom: 25px">
            <input type="checkbox" class="form-control" name="contratoAtivo" id="field_ativo"
              [(ngModel)]="novoContrato.ativo" />
            <label class="form-control-label" for="field_ativo">Ativo</label>
          </div>

          <div class="ui-g ui-md-12" style="justify-content: flex-end">
            <div class="ui-g-2">
              <button pButton type="text" label="Cancelar"
                (click)="fecharDialogCadastroContrato()"></button>
            </div>
            <div class="ui-g-2">
              <button pButton type="button" label="Salvar" 
                (click)="adicionarContrato()"></button>
            </div>
          </div>
        </p-dialog>

      </form>
    </div>
  </div>
</div>